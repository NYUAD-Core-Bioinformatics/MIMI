<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detailed Workflow &mdash; Mass Spectrometry Tool 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command Reference" href="command_reference.html" />
    <link rel="prev" title="Quick Start Guide" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Mass Spectrometry Tool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Detailed Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-preparation">Database Preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmdb-extraction">HMDB Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kegg-extraction">KEGG Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-database">Custom Database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cache-creation">Cache Creation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cache-inspection">Cache Inspection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sample-analysis">Sample Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-analysis">Basic Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-cache-analysis">Multiple Cache Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-processing">Batch Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ppm-threshold-optimization">PPM Threshold Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#result-interpretation">Result Interpretation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices-and-troubleshooting">Best Practices and Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_reference.html">Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mass Spectrometry Tool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Detailed Workflow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/workflow.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="detailed-workflow">
<h1>Detailed Workflow<a class="headerlink" href="#detailed-workflow" title="Permalink to this headline"></a></h1>
<p>This document provides a detailed explanation of MIMI’s workflow for mass spectrometry data analysis.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>MIMI’s workflow consists of three main phases:</p>
<ol class="arabic simple">
<li><p><strong>Database Preparation</strong>: Extract and format compound data</p></li>
<li><p><strong>Cache Creation</strong>: Precompute molecular masses and isotope patterns</p></li>
<li><p><strong>Sample Analysis</strong>: Match sample masses against cached data</p></li>
</ol>
<p>Each phase is described in detail below.</p>
</section>
<section id="database-preparation">
<h2>Database Preparation<a class="headerlink" href="#database-preparation" title="Permalink to this headline"></a></h2>
<p>Before analysis, you need a database of compounds with their chemical formulas. MIMI provides tools to extract this information from common databases:</p>
<section id="hmdb-extraction">
<h3>HMDB Extraction<a class="headerlink" href="#hmdb-extraction" title="Permalink to this headline"></a></h3>
<p>The Human Metabolome Database (HMDB) contains detailed information about small molecule metabolites found in the human body.</p>
<ol class="arabic">
<li><p>Download the HMDB database XML file from <a class="reference external" href="https://hmdb.ca/downloads">https://hmdb.ca/downloads</a></p></li>
<li><p>Extract metabolites using the MIMI tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_hmdb_extract</span> <span class="o">-</span><span class="n">x</span> <span class="n">hmdb_metabolites</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="n">o</span> <span class="n">hmdb_compounds</span><span class="o">.</span><span class="n">tsv</span> <span class="o">-</span><span class="n">l</span> <span class="mi">100</span> <span class="o">-</span><span class="n">u</span> <span class="mi">500</span>
</pre></div>
</div>
</li>
</ol>
<p>This extracts metabolites with molecular weights between 100 and 500 Da.</p>
</section>
<section id="kegg-extraction">
<h3>KEGG Extraction<a class="headerlink" href="#kegg-extraction" title="Permalink to this headline"></a></h3>
<p>The Kyoto Encyclopedia of Genes and Genomes (KEGG) provides a comprehensive database of compounds.</p>
<ol class="arabic">
<li><p>Extract compounds by mass range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_kegg_extract</span> <span class="o">-</span><span class="n">l</span> <span class="mi">100</span> <span class="o">-</span><span class="n">u</span> <span class="mi">500</span> <span class="o">-</span><span class="n">o</span> <span class="n">kegg_compounds</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
</li>
<li><p>Or extract specific compounds by ID:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_kegg_extract</span> <span class="o">-</span><span class="n">i</span> <span class="n">compound_ids</span><span class="o">.</span><span class="n">tsv</span> <span class="o">-</span><span class="n">o</span> <span class="n">kegg_compounds</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
</li>
</ol>
<p>Example of <code class="docutils literal notranslate"><span class="pre">compound_ids.tsv</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span>
<span class="n">C00003</span>
<span class="n">C00006</span>
<span class="n">C00015</span>
<span class="n">C00016</span>
<span class="n">C00018</span>
<span class="n">C00019</span>
<span class="n">C00021</span>
<span class="n">C00024</span>
</pre></div>
</div>
<p>This file should contain a header row with <strong>ID</strong> followed by the KEGG compound IDs you wish to extract.</p>
<p>You can download a sample <code class="docutils literal notranslate"><span class="pre">compound_ids.tsv</span></code> file from the following link: <a class="reference external" href="https://raw.githubusercontent.com/NYUAD-Core-Bioinformatics/MIMI/main/data/processed/compound_ids.tsv">compound_ids.tsv</a></p>
</section>
<section id="custom-database">
<h3>Custom Database<a class="headerlink" href="#custom-database" title="Permalink to this headline"></a></h3>
<p>You can also create your own compound database as a TSV file. While the file can include other metadata, it must contain the following mandatory columns:</p>
<ol class="arabic simple">
<li><p><strong>CF</strong>: Chemical formula (e.g., C6H12O6)</p></li>
<li><p><strong>ID</strong>: Compound identifier</p></li>
<li><p><strong>Name</strong>: Compound name</p></li>
</ol>
<p>These columns can appear in any order within the file.</p>
<p>Updated Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CF</span>      <span class="n">ID</span>        <span class="n">Name</span>
<span class="n">C6H12O6</span> <span class="n">C00031</span>    <span class="n">Glucose</span>
<span class="n">C5H10O5</span> <span class="n">C00036</span>    <span class="n">Ribose</span>
<span class="n">C3H7NO2</span> <span class="n">C00041</span>    <span class="n">Alanine</span>
<span class="n">C7H6O2</span>  <span class="n">C00042</span>    <span class="n">Benzoic</span> <span class="n">Acid</span>
<span class="n">C4H8O4</span>  <span class="n">C00043</span>    <span class="n">Erythritol</span>
</pre></div>
</div>
<p>Ensure that your TSV file includes a header row and follows this format for compatibility with MIMI.</p>
</section>
</section>
<section id="cache-creation">
<h2>Cache Creation<a class="headerlink" href="#cache-creation" title="Permalink to this headline"></a></h2>
<p>Once you have your compound database, create cache files for efficient analysis:</p>
<ol class="arabic">
<li><p><strong>Natural abundance cache</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_cache_create</span> <span class="o">-</span><span class="n">i</span> <span class="n">neg</span> <span class="o">-</span><span class="n">d</span> <span class="n">data</span><span class="o">/</span><span class="n">processed</span><span class="o">/</span><span class="n">KEGGDB</span><span class="o">.</span><span class="n">tsv</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_nat</span>
</pre></div>
</div>
</li>
<li><p><strong>Labeled compounds cache</strong> (e.g., 95% C13-labeled):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_cache_create</span> <span class="o">-</span><span class="n">i</span> <span class="n">neg</span> <span class="o">-</span><span class="n">l</span> <span class="n">data</span><span class="o">/</span><span class="n">processed</span><span class="o">/</span><span class="n">C13_95</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">d</span> <span class="n">data</span><span class="o">/</span><span class="n">processed</span><span class="o">/</span><span class="n">KEGGDB</span><span class="o">.</span><span class="n">tsv</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_13C</span>
</pre></div>
</div>
</li>
</ol>
<dl class="simple">
<dt>Parameters:</dt><dd><ul class="simple">
<li><p><cite>-i neg</cite>: Ionization mode (negative)</p></li>
<li><p><cite>-d data/processed/KEGGDB.tsv</cite>: Input database file</p></li>
<li><p><cite>-c db_nat</cite>: Output cache file name</p></li>
<li><p><cite>-l data/processed/C13_95.json</cite>: Optional labeled atoms configuration</p></li>
</ul>
</dd>
</dl>
<p>Example C13 labeling configuration (C13_95.json):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;element_symbol&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nominal_mass&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
            <span class="s2">&quot;exact_mass&quot;</span><span class="p">:</span> <span class="mf">12.000</span><span class="p">,</span>
            <span class="s2">&quot;natural_abundance&quot;</span><span class="p">:</span> <span class="mf">0.05</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;element_symbol&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nominal_mass&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
            <span class="s2">&quot;exact_mass&quot;</span><span class="p">:</span> <span class="mf">13.00335484</span><span class="p">,</span>
            <span class="s2">&quot;natural_abundance&quot;</span><span class="p">:</span> <span class="mf">0.95</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="cache-inspection">
<h3>Cache Inspection<a class="headerlink" href="#cache-inspection" title="Permalink to this headline"></a></h3>
<p>To verify the contents of your cache files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_cache_dump</span> <span class="o">-</span><span class="n">n</span> <span class="mi">5</span> <span class="o">-</span><span class="n">i</span> <span class="mi">2</span> <span class="n">outdir</span><span class="o">/</span><span class="n">db_nat</span><span class="o">.</span><span class="n">pkl</span>

<span class="c1"># Cache Metadata:</span>
<span class="c1"># Creation Date: YYYY-MM-DDTHH:MM:SS</span>
<span class="c1"># MIMI Version: 1.0.0</span>

<span class="c1"># Creation Parameters:</span>
<span class="c1"># Full Command: /path/to/mimi_cache_create -i neg -d path/to/KEGGDB.tsv -c outdir/db_nat</span>
<span class="c1"># Ionization Mode: neg</span>
<span class="c1"># Labeled Atoms File: None</span>
<span class="c1"># Compound DB Files: path/to/KEGGDB.tsv</span>
<span class="c1"># Cache Output File: outdir/db_nat.pkl</span>
<span class="c1"># Isotope Data File: path/to/natural_isotope_abundance_NIST.json</span>

<span class="o">============================================================</span>
<span class="n">Compound</span> <span class="n">ID</span><span class="p">:</span>      <span class="n">C00003</span>
<span class="n">Name</span><span class="p">:</span>             <span class="n">NAD</span><span class="o">+</span>
<span class="n">Formula</span><span class="p">:</span>          <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C21</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H28</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N7</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O14</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
<span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>    <span class="n">Yes</span> <span class="p">(</span><span class="n">most</span> <span class="n">abundant</span> <span class="n">isotope</span><span class="p">)</span>
<span class="n">Mass</span><span class="p">:</span>             <span class="mf">663.109671</span>
<span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span>   <span class="mf">1.000000</span> <span class="p">(</span><span class="n">reference</span><span class="p">)</span>
<span class="o">------------------------------------------------------------</span>
<span class="n">ISOTOPE</span> <span class="n">VARIANTS</span><span class="p">:</span>
  <span class="n">Variant</span> <span class="c1">#1:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C20</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="n">C1</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H28</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N7</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O14</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">664.113026</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.227130</span>
<span class="o">------------------------------------------------------------</span>
  <span class="n">Variant</span> <span class="c1">#2:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C21</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H28</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N7</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O13</span> <span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="n">O1</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">665.113916</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.028770</span>
<span class="o">------------------------------------------------------------</span>

<span class="o">============================================================</span>
<span class="n">Compound</span> <span class="n">ID</span><span class="p">:</span>      <span class="n">C00006</span>
<span class="n">Name</span><span class="p">:</span>             <span class="n">NADP</span><span class="o">+</span>
<span class="n">Formula</span><span class="p">:</span>          <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C21</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H29</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N7</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O17</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P3</span>
<span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>    <span class="n">Yes</span> <span class="p">(</span><span class="n">most</span> <span class="n">abundant</span> <span class="n">isotope</span><span class="p">)</span>
<span class="n">Mass</span><span class="p">:</span>             <span class="mf">743.076002</span>
<span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span>   <span class="mf">1.000000</span> <span class="p">(</span><span class="n">reference</span><span class="p">)</span>
<span class="o">------------------------------------------------------------</span>
<span class="n">ISOTOPE</span> <span class="n">VARIANTS</span><span class="p">:</span>
  <span class="n">Variant</span> <span class="c1">#1:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C20</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="n">C1</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H29</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N7</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O17</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P3</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">744.079357</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.227130</span>
<span class="o">------------------------------------------------------------</span>
  <span class="n">Variant</span> <span class="c1">#2:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C21</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H29</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N7</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O16</span> <span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="n">O1</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P3</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">745.080247</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.034935</span>
<span class="o">------------------------------------------------------------</span>

<span class="o">============================================================</span>
<span class="n">Compound</span> <span class="n">ID</span><span class="p">:</span>      <span class="n">C00015</span>
<span class="n">Name</span><span class="p">:</span>             <span class="n">UDP</span>
<span class="n">Formula</span><span class="p">:</span>          <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C9</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H14</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N2</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O12</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
<span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>    <span class="n">Yes</span> <span class="p">(</span><span class="n">most</span> <span class="n">abundant</span> <span class="n">isotope</span><span class="p">)</span>
<span class="n">Mass</span><span class="p">:</span>             <span class="mf">402.994921</span>
<span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span>   <span class="mf">1.000000</span> <span class="p">(</span><span class="n">reference</span><span class="p">)</span>
<span class="o">------------------------------------------------------------</span>
<span class="n">ISOTOPE</span> <span class="n">VARIANTS</span><span class="p">:</span>
  <span class="n">Variant</span> <span class="c1">#1:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C8</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="n">C1</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H14</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N2</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O12</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">403.998276</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.097342</span>
<span class="o">------------------------------------------------------------</span>
  <span class="n">Variant</span> <span class="c1">#2:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C9</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H14</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N2</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O11</span> <span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="n">O1</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">404.999166</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.024660</span>
<span class="o">------------------------------------------------------------</span>

<span class="o">============================================================</span>
<span class="n">Compound</span> <span class="n">ID</span><span class="p">:</span>      <span class="n">C00016</span>
<span class="n">Name</span><span class="p">:</span>             <span class="n">FAD</span>
<span class="n">Formula</span><span class="p">:</span>          <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C27</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H33</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N9</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O15</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
<span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>    <span class="n">Yes</span> <span class="p">(</span><span class="n">most</span> <span class="n">abundant</span> <span class="n">isotope</span><span class="p">)</span>
<span class="n">Mass</span><span class="p">:</span>             <span class="mf">784.149859</span>
<span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span>   <span class="mf">1.000000</span> <span class="p">(</span><span class="n">reference</span><span class="p">)</span>
<span class="o">------------------------------------------------------------</span>
<span class="n">ISOTOPE</span> <span class="n">VARIANTS</span><span class="p">:</span>
  <span class="n">Variant</span> <span class="c1">#1:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C26</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="n">C1</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H33</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N9</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O15</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">785.153214</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.292025</span>
<span class="o">------------------------------------------------------------</span>
  <span class="n">Variant</span> <span class="c1">#2:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C27</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H33</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N8</span> <span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="n">N1</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O15</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P2</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">785.146894</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.032880</span>
<span class="o">------------------------------------------------------------</span>

<span class="o">============================================================</span>
<span class="n">Compound</span> <span class="n">ID</span><span class="p">:</span>      <span class="n">C00018</span>
<span class="n">Name</span><span class="p">:</span>             <span class="n">Pyridoxal</span> <span class="n">phosphate</span>
<span class="n">Formula</span><span class="p">:</span>          <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C8</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H10</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O6</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P1</span>
<span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>    <span class="n">Yes</span> <span class="p">(</span><span class="n">most</span> <span class="n">abundant</span> <span class="n">isotope</span><span class="p">)</span>
<span class="n">Mass</span><span class="p">:</span>             <span class="mf">246.017298</span>
<span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span>   <span class="mf">1.000000</span> <span class="p">(</span><span class="n">reference</span><span class="p">)</span>
<span class="o">------------------------------------------------------------</span>
<span class="n">ISOTOPE</span> <span class="n">VARIANTS</span><span class="p">:</span>
  <span class="n">Variant</span> <span class="c1">#1:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C7</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="n">C1</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H10</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N1</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O6</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P1</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">247.020652</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.086526</span>
<span class="o">------------------------------------------------------------</span>
  <span class="n">Variant</span> <span class="c1">#2:</span>
  <span class="n">Formula</span><span class="p">:</span>        <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="n">C8</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">H10</span> <span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="n">N1</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="n">O5</span> <span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="n">O1</span> <span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="n">P1</span>
  <span class="n">Mono</span><span class="o">-</span><span class="n">isotopic</span><span class="p">:</span>  <span class="n">No</span> <span class="p">(</span><span class="n">isotope</span> <span class="n">variant</span><span class="p">)</span>
  <span class="n">Mass</span><span class="p">:</span>           <span class="mf">248.021543</span>
  <span class="n">Relative</span> <span class="n">Abund</span><span class="p">:</span> <span class="mf">0.012330</span>
<span class="o">------------------------------------------------------------</span>
</pre></div>
</div>
</section>
</section>
<section id="sample-analysis">
<h2>Sample Analysis<a class="headerlink" href="#sample-analysis" title="Permalink to this headline"></a></h2>
<p>With your cache files prepared, you can analyze mass spectrometry samples:</p>
<section id="basic-analysis">
<h3>Basic Analysis<a class="headerlink" href="#basic-analysis" title="Permalink to this headline"></a></h3>
<p>Analyze a single sample against a single cache:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_mass_analysis</span> <span class="o">-</span><span class="n">p</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">vp</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_nat</span> <span class="o">-</span><span class="n">s</span> <span class="n">data</span><span class="o">/</span><span class="n">processed</span><span class="o">/</span><span class="n">testdata1</span><span class="o">.</span><span class="n">asc</span> <span class="o">-</span><span class="n">o</span> <span class="n">results</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
<dl class="simple">
<dt>Parameters:</dt><dd><ul class="simple">
<li><p><cite>-p 1.0</cite>: PPM tolerance for initial mass matching</p></li>
<li><p><cite>-vp 1.0</cite>: PPM tolerance for isotope pattern verification</p></li>
<li><p><cite>-c db_nat</cite>: Cache file(s) to use</p></li>
<li><p><cite>-s data/processed/testdata1.asc</cite>: Sample file(s) to analyze</p></li>
<li><p><cite>-o results.tsv</cite>: Output file for results</p></li>
</ul>
</dd>
</dl>
</section>
<section id="multiple-cache-analysis">
<h3>Multiple Cache Analysis<a class="headerlink" href="#multiple-cache-analysis" title="Permalink to this headline"></a></h3>
<p>Analyze a sample against multiple caches simultaneously:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_mass_analysis</span> <span class="o">-</span><span class="n">p</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">vp</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_nat</span> <span class="n">db_13C</span> <span class="o">-</span><span class="n">s</span> <span class="n">data</span><span class="o">/</span><span class="n">sample</span><span class="o">.</span><span class="n">asc</span> <span class="o">-</span><span class="n">o</span> <span class="n">results</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
<p>This is useful for comparing natural abundance patterns with labeled patterns.</p>
</section>
<section id="batch-processing">
<h3>Batch Processing<a class="headerlink" href="#batch-processing" title="Permalink to this headline"></a></h3>
<p>Process multiple samples in a single run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mimi_mass_analysis</span> <span class="o">-</span><span class="n">p</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">vp</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_nat</span> <span class="o">-</span><span class="n">s</span> <span class="n">data</span><span class="o">/</span><span class="n">sample1</span><span class="o">.</span><span class="n">asc</span> <span class="n">data</span><span class="o">/</span><span class="n">sample2</span><span class="o">.</span><span class="n">asc</span> <span class="o">-</span><span class="n">o</span> <span class="n">batch_results</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
</section>
<section id="ppm-threshold-optimization">
<h3>PPM Threshold Optimization<a class="headerlink" href="#ppm-threshold-optimization" title="Permalink to this headline"></a></h3>
<p>The PPM threshold critically affects match precision and reliability:</p>
<ul class="simple">
<li><p><strong>Excellent (p=0.5, vp=0.5)</strong>: Highest confidence identifications, recommended for ultra-high resolution data</p></li>
<li><p><strong>Good (p=1.0, vp=1.0)</strong>: Reliable identifications when combined with isotope pattern validation</p></li>
<li><p><strong>Low Confidence (p=1.0-2.0, vp=1.0-2.0)</strong>: Use with caution, requires additional validation</p></li>
<li><p><strong>Not Recommended (p&gt;2.0, vp&gt;2.0)</strong>: Should not be used for ultra-high resolution MS data</p></li>
</ul>
<p>Example threshold usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Highest confidence analysis</span>
<span class="n">mimi_mass_analysis</span> <span class="o">-</span><span class="n">p</span> <span class="mf">0.5</span> <span class="o">-</span><span class="n">vp</span> <span class="mf">0.5</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_nat</span> <span class="o">-</span><span class="n">s</span> <span class="n">sample</span><span class="o">.</span><span class="n">asc</span> <span class="o">-</span><span class="n">o</span> <span class="n">results_excellent</span><span class="o">.</span><span class="n">tsv</span>

<span class="c1"># Good confidence analysis</span>
<span class="n">mimi_mass_analysis</span> <span class="o">-</span><span class="n">p</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">vp</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">c</span> <span class="n">db_nat</span> <span class="o">-</span><span class="n">s</span> <span class="n">sample</span><span class="o">.</span><span class="n">asc</span> <span class="o">-</span><span class="n">o</span> <span class="n">results_good</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
</section>
</section>
<section id="result-interpretation">
<h2>Result Interpretation<a class="headerlink" href="#result-interpretation" title="Permalink to this headline"></a></h2>
<p>The output TSV file contains the following columns:</p>
<ol class="arabic simple">
<li><p><strong>Compound ID</strong>: Identifier from the original database</p></li>
<li><p><strong>Formula</strong>: Chemical formula of the matched compound</p></li>
<li><p><strong>Name</strong>: Compound name</p></li>
<li><p><strong>Mass</strong>: Calculated mass of the compound</p></li>
<li><p><strong>Sample Mass</strong>: Observed mass in the sample</p></li>
<li><p><strong>PPM</strong>: Parts per million difference between calculated and observed mass</p></li>
<li><p><strong>Intensity</strong>: Signal intensity in the sample</p></li>
<li><p><strong>Isotope Score</strong>: Confidence score based on isotope pattern matching</p></li>
<li><p><strong>Cache Source</strong>: Which cache file provided the match</p></li>
</ol>
</section>
<section id="best-practices-and-troubleshooting">
<h2>Best Practices and Troubleshooting<a class="headerlink" href="#best-practices-and-troubleshooting" title="Permalink to this headline"></a></h2>
<p>Best Practices:</p>
<ol class="arabic simple">
<li><p>Use appropriate PPM thresholds based on instrument resolution:
- &lt;0.5 ppm: Excellent mass accuracy, highest confidence
- 0.5-1.0 ppm: Good mass accuracy, reliable with isotope validation
- 1.0-2.0 ppm: Low confidence, requires additional validation
- &gt;2.0 ppm: Not recommended for ultra-high resolution data</p></li>
<li><p>Always combine mass accuracy with isotope pattern matching</p></li>
<li><p>Use isotope score &gt; 0.8 for reliable matches</p></li>
<li><p>Compare results from natural and labeled caches</p></li>
<li><p>Process replicates together for consistency</p></li>
<li><p>Verify important matches manually</p></li>
</ol>
<p>Common Issues and Solutions:</p>
<ol class="arabic simple">
<li><p><strong>No matches found</strong>:
- Increase PPM threshold
- Verify sample format
- Check ionization mode</p></li>
<li><p><strong>Too many matches</strong>:
- Decrease PPM threshold
- Use stricter verification PPM
- Filter by isotope score</p></li>
<li><p><strong>Cache creation errors</strong>:
- Verify chemical formulas
- Check labeling configuration
- Enable debugging</p></li>
<li><p><strong>Performance issues</strong>:
- Use focused databases
- Process samples in smaller batches
- Optimize mass ranges</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="command_reference.html" class="btn btn-neutral float-right" title="Command Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Nabil Rahiman.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>